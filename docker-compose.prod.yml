# Definimos los servicios que componen la aplicación.
services:
  # Servicio principal de la aplicación web con Apache y PHP
  app:
    environment:
      # Entorno de CodeIgniter. Cambia a "production" en despliegues reales.
      APP_ENV: ${APP_ENV:-production}
      # Ejecuta las migraciones al arrancar si es "true".
      RUN_MIGRATIONS: ${RUN_MIGRATIONS:-true}
      # Espera a que la base de datos responda antes de arrancar Apache.
      WAIT_FOR_DB: ${WAIT_FOR_DB:-true}
    env_file:
      - .env.docker

  # Servicio auxiliar para ejecutar tareas de línea de comandos (migraciones, seeds, jobs, etc.)
  cli:
    environment:
      # Repetimos las variables de entorno porque este contenedor se ejecuta de forma independiente.
      APP_ENV: ${APP_ENV:-production}
    env_file:
      - .env.docker

